# HW10
## 1.  List all of the annotations you learned from class and homework to annotaitons.md
See [annotations.md](annotations.md)
## 2.  what is the @configuration and @bean?
### @Configuration
- Used to indicate that a class declares one or more @Bean methods and may be processed by the Spring container to generate bean definitions and service requests for those beans at runtime.
### @Beam
- Bean will be managed by the Spring container, making it available for dependency injection throughout the application.
```java
@Configuration
public class AppConfig {

    @Bean
    public DataSource dataSource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName("com.mysql.cj.jdbc.Driver");
        dataSource.setUrl("jdbc:mysql://localhost:3306/mydb");
        dataSource.setUsername("user");
        dataSource.setPassword("password");
        return dataSource;
    }

    @Bean
    public JdbcTemplate jdbcTemplate(DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }
}

```
## 3.  How do you handle the exceptions in Spring? How do you make sure you do NOT expose sensitive information?
- We can define custom exceptions so that we don't use the default error messages that exposes everything.
 - Generic Error Messages: Use generic error messages in the ErrorResponse to avoid revealing implementation details or sensitive data.
 - Logging: Log the detailed error messages and stack traces on the server side for debugging purposes but do not expose them to end users.
```java
public class ResourceNotFoundException extends RuntimeException {

    private String resourceName;
    private String fieldName;
    private long fieldValue;


    public ResourceNotFoundException(String resourceName, String fieldName, long fieldValue) {
        super(String.format("%s resource not found with %s: %s", resourceName, fieldName, fieldValue));
        this.resourceName = resourceName;
        this.fieldName = fieldName;
        this.fieldValue = fieldValue;
    }
}

@Override
public PostDto getPostById(long id) {
    Post post = postRepository.findById(id).orElseThrow(()->new ResourceNotFoundException("Post", "id", id));

    return posttoPostDto(post);
}

```
## 4.  How do you do validations in Spring? List some validation annotations you know. What's the purpose of validation?
- The purpose of validation is to ensure that the data being processed by an application meets certain criteria before it is used or persisted. This helps to maintain data integrity, prevent errors, and enhance security by validating user inputs.
- We can add validations to the fields n the model class, then call @Validate in the controller
```java
public class User {
    @NotNull(message = "ID cannot be null")
    private Long id;

    @NotEmpty(message = "Name cannot be empty")
    @Size(min = 2, max = 30, message = "Name must be between 2 and 30 characters")
    private String name;

    @Email(message = "Email should be valid")
    private String email;

    @Min(value = 18, message = "Age should not be less than 18")
    @Max(value = 100, message = "Age should not be more than 100")
    private int age;
    
}
public class UserController {

    @PostMapping
    public ResponseEntity<String> createUser(@Valid @RequestBody User user, BindingResult bindingResult) {
        //.....
    }
}
```
- Some Validation Annotations:
### @NotNull
- Ensures the annotated field is not null.
```java
@NotNull(message = "ID cannot be null")
private Long id;
```
### @NotEmpty
-  Ensures the annotated field is not empty (not null and not empty string).
```java
@NotEmpty(message = "Name cannot be empty")
private String name;

```
### @NotBlank
- Ensures the annotated field is not blank (not null and trimmed length > 0).
```java
@NotBlank(message = "Name cannot be blank")
private String name;
```
### @Size
-  Ensures the annotated field has a size between the specified min and max values.
```java
@Size(min = 2, max = 30, message = "Name must be between 2 and 30 characters")
private String name;
```
### @Min
- Ensures the annotated field has a value not less than the specified minimum.
```java
@Min(value = 18, message = "Age should not be less than 18")
private int age;
```
### @Max
- Ensures the annotated field has a value not more than the specified maximum.
```java
@Max(value = 100, message = "Age should not be more than 100")
private int age;
```
### @Email
- Ensures the annotated field is a valid email address.
```java
@Email(message = "Email should be valid")
private String email;

```
### @Past
- : Ensures the annotated field represents a date in the past.
```java
@Past(message = "Date of birth must be in the past")
private LocalDate dateOfBirth;
```
### @Future
-  Ensures the annotated field represents a date in the future.
```java
@Future(message = "Appointment date must be in the future")
private LocalDate appointmentDate;
```

## 5.  What is the actuator, list some endpoints and payload it provides?
- Actuator is a library that helps developers monitor and manage their Spring Boot applications.
- It provides endpoints that allow you to inspect the application's health, metrics, environment, and other runtime information.
- Endpoints:
### Actuator Endpoints

1. **/actuator/health**
    - **Purpose**: Displays the health status of the application.
      ```json
      {
        "status": "UP",
        "components": {
          "db": {
            "status": "UP",
            "details": {
              "database": "H2",
              "result": 1
            }
          },
          "diskSpace": {
            "status": "UP",
            "details": {
              "total": 499963174912,
              "free": 318034345984,
              "threshold": 10485760
            }
          }
        }
      }
      ```

2. **/actuator/metrics**
    - **Purpose**: Provides access to various metrics collected by the application.
      ```json
      {
        "names": [
          "jvm.memory.used",
          "jvm.gc.pause",
          "http.server.requests",
          "system.cpu.usage",
          "process.uptime"
        ]
      }
      ```

3. **/actuator/info**
    - **Purpose**: Displays arbitrary application info, typically populated from `application.properties` or `application.yml`.
      ```json
      {
        "app": {
          "name": "MyApp",
          "description": "Sample Spring Boot Application",
          "version": "1.0.0"
        }
      }
      ```

4. **/actuator/env**
    - **Purpose**: Shows the properties and configuration of the running environment.
      ```json
      {
        "activeProfiles": [],
        "propertySources": [
          {
            "name": "systemProperties",
            "properties": {
              "java.runtime.name": {
                "value": "Java(TM) SE Runtime Environment"
              },
              "java.vm.version": {
                "value": "25.171-b11"
              }
            }
          },
          {
            "name": "applicationConfig: [classpath:/application.yml]",
            "properties": {
              "spring.application.name": {
                "value": "demo"
              }
            }
          }
        ]
      }
      ```

5. **/actuator/loggers**
    - **Purpose**: Shows and manages the configuration of loggers in the application.
      ```json
      {
        "levels": [
          "OFF",
          "ERROR",
          "WARN",
          "INFO",
          "DEBUG",
          "TRACE"
        ],
        "loggers": {
          "ROOT": {
            "configuredLevel": "INFO",
            "effectiveLevel": "INFO"
          },
          "org.springframework": {
            "configuredLevel": "WARN",
            "effectiveLevel": "WARN"
          }
        }
      }
      ```

6. **/actuator/beans**
    - **Purpose**: Displays a complete list of all the Spring beans in the application context.
      ```json
      {
        "contexts": {
          "application": {
            "beans": {
              "myService": {
                "aliases": [],
                "scope": "singleton",
                "type": "com.example.MyService",
                "resource": "file:src/main/java/com/example/MyService.java",
                "dependencies": []
              },
              "dataSource": {
                "aliases": [],
                "scope": "singleton",
                "type": "org.apache.tomcat.jdbc.pool.DataSource",
                "resource": "file:src/main/resources/application.yml",
                "dependencies": []
              }
            }
          }
        }
      }
      ```

7. **/actuator/threaddump**
    - **Purpose**: Provides a thread dump from the JVM showing the current state of all threads.
      ```json
      {
        "threads": [
          {
            "threadName": "main",
            "threadId": 1,
            "blockedTime": -1,
            "blockedCount": 0,
            "waitedTime": -1,
            "waitedCount": 0,
            "lockName": null,
            "lockOwnerId": -1,
            "lockOwnerName": null,
            "inNative": false,
            "suspended": false,
            "threadState": "RUNNABLE",
            "stackTrace": [
              {
                "methodName": "run",
                "fileName": "Main.java",
                "lineNumber": 34,
                "className": "com.example.Main",
                "nativeMethod": false
              }
            ]
          }
        ]
      }
      ```

## 6.  Apply above annotations to your previous homework projects as possible as you can.
See past homeworks.
## 7.  watch those videos(泛泛地看一遍，能理解多少是多少，没有必要看其它视频。)
- 1.  Spring 简介： https://www.youtube.com/watch?v=l0MqsOADAUE&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=64
- 2.  IOC/DI: https://www.youtube.com/watch?v=PyMxNr2p0C0&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=65
- 3.  IOC container: https://www.youtube.com/watch?v=pLa77Tw-yyI&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=66
- 4.  Bean:
 - 1.  https://www.youtube.com/watch?v=OpgMHzM7tgQ&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=67
 - 2.  https://www.youtube.com/watch?v=OpgMHzM7tgQ&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=68
 - 3.  https://www.youtube.com/watch?v=OpgMHzM7tgQ&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=69
- 5.  DI:
 - 1.  https://www.youtube.com/watch?v=MgTpBST9onM&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=70
 - 2.  https://www.youtube.com/watch?v=yhEWZx2i1BA&list=PLmOn9nNkQxJFbsU4Qz8CdRiVM4Qs3ci75&index=71